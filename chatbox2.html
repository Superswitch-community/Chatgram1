<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatGram Social AI</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body id="body" class="bg-gray-100 flex items-center justify-center h-screen transition-all">

<div class="w-full max-w-md h-[95vh] bg-white dark:bg-gray-900 shadow-2xl rounded-3xl flex flex-col overflow-hidden transition-all">

    <!-- Header -->
    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-4 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <img src="https://i.pravatar.cc/40?img=5" class="rounded-full w-10 h-10">
            <div>
                <h1 class="font-bold">ChatGram AI</h1>
                <p class="text-xs opacity-80">Online</p>
            </div>
        </div>
        <button onclick="toggleDark()" class="text-sm bg-white text-black px-2 py-1 rounded">ðŸŒ™</button>
    </div>

    <!-- Chat Area -->
    <div id="chatBox" class="flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50 dark:bg-gray-800 transition-all"></div>

    <!-- Input -->
    <div class="p-3 border-t dark:border-gray-700 flex gap-2 bg-white dark:bg-gray-900">
        <input id="userInput" type="text"
            placeholder="Send a message..."
            class="flex-1 border dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
        <button onclick="sendMessage()"
            class="bg-indigo-600 text-white px-5 py-2 rounded-full hover:bg-indigo-700 transition">
            Send
        </button>
    </div>

</div>

<script>

const chatBox = document.getElementById("chatBox");
const userInput = document.getElementById("userInput");
const body = document.getElementById("body");

// ðŸ”¥ PUT YOUR OPENAI API KEY HERE
const OPENAI_API_KEY = "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";

let conversation = [
  { role: "system", content: "You are a friendly social media AI assistant." }
];

userInput.addEventListener("keypress", function(e){
    if(e.key === "Enter") sendMessage();
});

function toggleDark(){
    body.classList.toggle("dark");
    body.classList.toggle("bg-gray-100");
    body.classList.toggle("bg-gray-900");
}

function addMessage(text, isUser){

    const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

    const div = document.createElement("div");
    div.className = isUser ? "flex justify-end items-end gap-2" : "flex items-end gap-2";

    div.innerHTML = `
        ${!isUser ? `<img src="https://i.pravatar.cc/40?img=5" class="w-8 h-8 rounded-full">` : ""}
        <div>
            <div class="${isUser ? 'bg-indigo-600 text-white' : 'bg-gray-300 dark:bg-gray-700 dark:text-white'} 
                p-3 rounded-2xl max-w-xs shadow">
                ${text}
            </div>
            <div class="text-xs text-gray-400 mt-1">${time}</div>
        </div>
        ${isUser ? `<img src="https://i.pravatar.cc/40?img=3" class="w-8 h-8 rounded-full">` : ""}
    `;

    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
}

function showTyping(){
    const typing = document.createElement("div");
    typing.id = "typing";
    typing.className = "text-sm text-gray-500";
    typing.innerText = "AI is typing...";
    chatBox.appendChild(typing);
    chatBox.scrollTop = chatBox.scrollHeight;
}

function removeTyping(){
    const typing = document.getElementById("typing");
    if(typing) typing.remove();
}

async function sendMessage(){

    const message = userInput.value.trim();
    if(!message) return;

    addMessage(message, true);
    conversation.push({ role: "user", content: message });
    userInput.value = "";

    showTyping();

    try {

        const response = await fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + OPENAI_API_KEY
            },
            body: JSON.stringify({
                model: "gpt-4o-mini",
                messages: conversation
            })
        });

        const data = await response.json();
        removeTyping();

        const reply = data.choices[0].message.content;

        addMessage(reply, false);
        conversation.push({ role: "assistant", content: reply });

    } catch(error){
        removeTyping();
        addMessage("Error connecting to OpenAI.", false);
    }
}

</script>

</body>
</html>
